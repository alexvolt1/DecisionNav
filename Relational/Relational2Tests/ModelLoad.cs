using System;
using Infor.PM.Decision.DecisionCore;
using Infor.PM.Common.ConnectionDefinitions;
using Infor.PM.Decision.DecisionCore.Server;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace RelationalTests
{
    [TestClass]
    public class ModelLoad
    {

        //string serializedViewSession = "AAEAAAD/////AQAAAAAAAAAMAgAAAENEZWNpc2lvbkNvcmUsIFZlcnNpb249MS4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsBQEAAAAqSW5mb3IuUE0uRGVjaXNpb24uRGVjaXNpb25Db3JlLlZpZXdTZXNzaW9uFAAAAA5tb2RlbFNoYXBlRGF0ZRN1c2VyU2VjdXJlU2hhcGVEYXRlCGNhY2hlS2V5D3Nlc3Npb25DYWNoZUtleRdzZXNzaW9uQ2FjaGVLZXlXaXRoVXNlcgx2aWV3c0RCQWxpYXMIdmlld05hbWUQZGF0YWJhc2VVc2VyTmFtZQtzZXNzaW9uRGF0YRlhbGxvd2VkTWVtYmVyc0xhc3RDaGFuZ2VkEGNvbm5lY3Rpb25Tb3VyY2UVY2xpZW50UHJvY2Vzc0NvbXBsZXRlGjxUb3BpY0luZm8+a19fQmFja2luZ0ZpZWxkITxEYXRhYmFzZVBhc3N3b3JkPmtfX0JhY2tpbmdGaWVsZBg8Q3VsdHVyZT5rX19CYWNraW5nRmllbGQgPEZvcmNlQWRtaW5Mb2dpbj5rX19CYWNraW5nRmllbGQoPEZvcm1hdHRlZE1vZGVsU2hhcGVEYXRlPmtfX0JhY2tpbmdGaWVsZC08Rm9ybWF0dGVkVXNlclNlY3VyZVNoYXBlRGF0ZT5rX19CYWNraW5nRmllbGQfPENvbm5lY3Rpb25OYW1lPmtfX0JhY2tpbmdGaWVsZBk8Q3ViZU5hbWU+a19fQmFja2luZ0ZpZWxkAAABAQEBAQEBAAQABAEDAAEBAQENDQ0vSW5mb3IuUE0uRGVjaXNpb24uRGVjaXNpb25Db3JlLkNvbm5lY3Rpb25Tb3VyY2UCAAAAARlJbnRlcm5hbC5TZXJ2ZXIuVG9waWNJbmZvAgAAACBTeXN0ZW0uR2xvYmFsaXphdGlvbi5DdWx0dXJlSW5mbwECAAAAAAAAAAAAAAAAAAAAAAAAAAYDAAAAPSNSQUJPX1ZJRVdTI1JBRl9PQVJfUFJPQ0JZU1RBR0UjQ0xJRU5UI1JSWVZLSU5ARFNTUFJFUFJPRC5DT00GBAAAAD4jUkFCT19WSUVXUyNSQUZfT0FSX1BST0NCWVNUQUdFI0NMSUVOVCMyMDE4LzAyLzA3IDA5OjMxOjQ2LjAwMAYFAAAAVSNSQUJPX1ZJRVdTI1JBRl9PQVJfUFJPQ0JZU1RBR0UjQ0xJRU5UIzIwMTgvMDIvMDcgMDk6MzE6NDYuMDAwI1JSWVZLSU5ARFNTUFJFUFJPRC5DT00GBgAAAApSQUJPX1ZpZXdzBgcAAAATUkFGX09BUl9Qcm9jQnlTdGFnZQYIAAAAFnJyeXZraW5AZHNzcHJlcHJvZC5jb20GCQAAADwyMDE4LzA0LzE5IDA4OjU0OjM2LjYwOSNhNTVhZmY1ZS05YzM2LTQwYzgtOTE0OS1iYjAyODZkOTQ1NDUAbS+bDW7VCAX2////L0luZm9yLlBNLkRlY2lzaW9uLkRlY2lzaW9uQ29yZS5Db25uZWN0aW9uU291cmNlAQAAAAd2YWx1ZV9fAAgCAAAAAgAAAAAJCwAAAAYMAAAACEtpcm92YTY0CQ0AAAAABg4AAAAXMDAwMS8wMS8wMSAwMDowMDowMC4wMDAGDwAAABcwMDAxLzAxLzAxIDAwOjAwOjAwLjAwMAYQAAAAC1JBRiBQUk9EIE9BBhEAAAAFT0EgRFcFCwAAABlJbnRlcm5hbC5TZXJ2ZXIuVG9waWNJbmZvAgAAABo8VG9waWNOYW1lPmtfX0JhY2tpbmdGaWVsZBg8VG9waWNJZD5rX19CYWNraW5nRmllbGQBAQIAAAAGEgAAACdBcHBsaWNhdGlvbiBWYWx1ZSAmYW1wOyBWb2x1bWUgYnkgU3RhZ2UGEwAAACQwZjc3NmM0ZC0yOGI5LTRkM2YtYWIzNi0zNTdlYTU2NjYyOWYEDQAAACBTeXN0ZW0uR2xvYmFsaXphdGlvbi5DdWx0dXJlSW5mbwoAAAAMbV9pc1JlYWRPbmx5C2NvbXBhcmVJbmZvCHRleHRJbmZvB251bUluZm8MZGF0ZVRpbWVJbmZvCGNhbGVuZGFyCm1fZGF0YUl0ZW0JY3VsdHVyZUlEBm1fbmFtZRFtX3VzZVVzZXJPdmVycmlkZQADAwMDAwAAAQABIFN5c3RlbS5HbG9iYWxpemF0aW9uLkNvbXBhcmVJbmZvHVN5c3RlbS5HbG9iYWxpemF0aW9uLlRleHRJbmZvJVN5c3RlbS5HbG9iYWxpemF0aW9uLk51bWJlckZvcm1hdEluZm8nU3lzdGVtLkdsb2JhbGl6YXRpb24uRGF0ZVRpbWVGb3JtYXRJbmZvHVN5c3RlbS5HbG9iYWxpemF0aW9uLkNhbGVuZGFyCAgBAAkUAAAACgoKCgAAAAAJBAAABhUAAAAFZW4tVVMBBBQAAAAgU3lzdGVtLkdsb2JhbGl6YXRpb24uQ29tcGFyZUluZm8EAAAABm1fbmFtZQl3aW4zMkxDSUQHY3VsdHVyZQ1tX1NvcnRWZXJzaW9uAQAAAwgIIFN5c3RlbS5HbG9iYWxpemF0aW9uLlNvcnRWZXJzaW9uBhYAAAAFZW4tVVMAAAAACQQAAAoL";
        //string serializedAdomdConnectionDefinition = "AAEAAAD/////AQAAAAAAAAAMAgAAAExDb25uZWN0aW9uRGVmaW5pdGlvbnMsIFZlcnNpb249MS4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsBQEAAAA8SW5mb3IuUE0uQ29tbW9uLkNvbm5lY3Rpb25EZWZpbml0aW9ucy5Bc0Nvbm5lY3Rpb25EZWZpbml0aW9uDAAAADFBZG9tZENvbm5lY3Rpb25EZWZpbml0aW9uKzxTZXJ2ZXI+a19fQmFja2luZ0ZpZWxkMUFkb21kQ29ubmVjdGlvbkRlZmluaXRpb24rPFVzZXJJZD5rX19CYWNraW5nRmllbGQ8QWRvbWRDb25uZWN0aW9uRGVmaW5pdGlvbis8RW5jcnlwdGVkUGFzc3dvcmQ+a19fQmFja2luZ0ZpZWxkKENvbm5lY3Rpb25EZWZpbml0aW9uKzxJZD5rX19CYWNraW5nRmllbGQqQ29ubmVjdGlvbkRlZmluaXRpb24rPE5hbWU+a19fQmFja2luZ0ZpZWxkMUNvbm5lY3Rpb25EZWZpbml0aW9uKzxEZXNjcmlwdGlvbj5rX19CYWNraW5nRmllbGQuQ29ubmVjdGlvbkRlZmluaXRpb24rPENhdGVnb3J5PmtfX0JhY2tpbmdGaWVsZDRDb25uZWN0aW9uRGVmaW5pdGlvbis8Q29ubmVjdGlvblR5cGU+a19fQmFja2luZ0ZpZWxkLkNvbm5lY3Rpb25EZWZpbml0aW9uKzxEYXRhYmFzZT5rX19CYWNraW5nRmllbGQ2Q29ubmVjdGlvbkRlZmluaXRpb24rPExhc3RNb2RpZmllZFVzZXI+a19fQmFja2luZ0ZpZWxkMkNvbm5lY3Rpb25EZWZpbml0aW9uKzxMYXN0TW9kaWZpZWQ+a19fQmFja2luZ0ZpZWxkPkNvbm5lY3Rpb25EZWZpbml0aW9uKzxFeHRlbmRlZENvbm5lY3Rpb25TdHJpbmc+a19fQmFja2luZ0ZpZWxkAQEBAwEBBAQBAQEBC1N5c3RlbS5HdWlkOEluZm9yLlBNLkNvbW1vbi5Db25uZWN0aW9uRGVmaW5pdGlvbnMuQ29ubmVjdGlvbkNhdGVnb3J5AgAAADRJbmZvci5QTS5Db21tb24uQ29ubmVjdGlvbkRlZmluaXRpb25zLkNvbm5lY3Rpb25UeXBlAgAAAAIAAAAGAwAAADhodHRwOi8vZHNzYXBwMDMuZHNzcHJlcHJvZC5jb20vZGF0YXB1bXBfcmFmL21zbWRwdW1wLmRsbAYEAAAAFWRzc3ByZXByb2RccnJ5dmtpbl9mYQYFAAAASCN2ZW5jcnlwdGVkI1R4YVJyQWt5VHhhUnJBbHpmNWZaOUpxRkN1dElWNXhMdStjWUhaR3BoUG54UDd2Ymdjd3FNTlZxZTZjPQT6////C1N5c3RlbS5HdWlkCwAAAAJfYQJfYgJfYwJfZAJfZQJfZgJfZwJfaAJfaQJfagJfawAAAAAAAAAAAAAACAcHAgICAgICAgLicrH5FiyrSavpzAJ64LkIBgcAAAALUkFGIFBST0QgT0EGCAAAAAAF9////zhJbmZvci5QTS5Db21tb24uQ29ubmVjdGlvbkRlZmluaXRpb25zLkNvbm5lY3Rpb25DYXRlZ29yeQEAAAAHdmFsdWVfXwAIAgAAAAEAAAAF9v///zRJbmZvci5QTS5Db21tb24uQ29ubmVjdGlvbkRlZmluaXRpb25zLkNvbm5lY3Rpb25UeXBlAQAAAAd2YWx1ZV9fAAgCAAAAAQAAAAYLAAAAC1JBRiBQUk9EIE9BCQgAAAAGDQAAABAyMDE4LTAyLTA3IDExOjU3Cgs=";


        string serializedViewSession = "AAEAAAD/////AQAAAAAAAAAMAgAAAENEZWNpc2lvbkNvcmUsIFZlcnNpb249MS4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsBQEAAAAqSW5mb3IuUE0uRGVjaXNpb24uRGVjaXNpb25Db3JlLlZpZXdTZXNzaW9uFQAAAA5tb2RlbFNoYXBlRGF0ZRN1c2VyU2VjdXJlU2hhcGVEYXRlCGNhY2hlS2V5D3Nlc3Npb25DYWNoZUtleRdzZXNzaW9uQ2FjaGVLZXlXaXRoVXNlcgx2aWV3c0RCQWxpYXMIdmlld05hbWUQZGF0YWJhc2VVc2VyTmFtZQtzZXNzaW9uRGF0YRlhbGxvd2VkTWVtYmVyc0xhc3RDaGFuZ2VkEGNvbm5lY3Rpb25Tb3VyY2UVY2xpZW50UHJvY2Vzc0NvbXBsZXRlGjxUb3BpY0luZm8+a19fQmFja2luZ0ZpZWxkJDxEeW5hbWljRGF0YWJhc2VOYW1lPmtfX0JhY2tpbmdGaWVsZCE8RGF0YWJhc2VQYXNzd29yZD5rX19CYWNraW5nRmllbGQYPEN1bHR1cmU+a19fQmFja2luZ0ZpZWxkIDxGb3JjZUFkbWluTG9naW4+a19fQmFja2luZ0ZpZWxkKDxGb3JtYXR0ZWRNb2RlbFNoYXBlRGF0ZT5rX19CYWNraW5nRmllbGQtPEZvcm1hdHRlZFVzZXJTZWN1cmVTaGFwZURhdGU+a19fQmFja2luZ0ZpZWxkHzxDb25uZWN0aW9uTmFtZT5rX19CYWNraW5nRmllbGQZPEN1YmVOYW1lPmtfX0JhY2tpbmdGaWVsZAAAAQEBAQEBAQAEAAQBAQMAAQEBAQ0NDS9JbmZvci5QTS5EZWNpc2lvbi5EZWNpc2lvbkNvcmUuQ29ubmVjdGlvblNvdXJjZQIAAAABGUludGVybmFsLlNlcnZlci5Ub3BpY0luZm8CAAAAIFN5c3RlbS5HbG9iYWxpemF0aW9uLkN1bHR1cmVJbmZvAQIAAAAAAAAAAAAAAAAAAAAAAAAABgMAAABGI0NJQl9WSUVXUyNDSUJfQ0xPX0lOUFJPQ0VTU1VOSVRTI0NMSUVOVCNDSUJfQUZTUlJZVktJTkBEU1NQUkVQUk9ELkNPTQYEAAAAQCNDSUJfVklFV1MjQ0lCX0NMT19JTlBST0NFU1NVTklUUyNDTElFTlQjMjAxOC8wNi8yOCAxMToxNToyOC4wMDAGBQAAAF4jQ0lCX1ZJRVdTI0NJQl9DTE9fSU5QUk9DRVNTVU5JVFMjQ0xJRU5UIzIwMTgvMDYvMjggMTE6MTU6MjguMDAwI0NJQl9BRlNSUllWS0lOQERTU1BSRVBST0QuQ09NBgYAAAAJQ0lCX1ZpZXdzBgcAAAAWQ0lCX0NMT19JblByb2Nlc3NVbml0cwYIAAAAHWNpYl9hZnNycnl2a2luQGRzc3ByZXByb2QuY29tBgkAAAA8MjAxOC8wNy8yNiAxMzozNjoyMi44MTUjMjc2ODBjOWQtNTVkOS00NDkzLTg5NDUtYjNhY2UyN2Q5YWNhAAgIdOjc1QgF9v///y9JbmZvci5QTS5EZWNpc2lvbi5EZWNpc2lvbkNvcmUuQ29ubmVjdGlvblNvdXJjZQEAAAAHdmFsdWVfXwAIAgAAAAIAAAAACQsAAAAKBgwAAAAIS2lyb3ZhNjYJDQAAAAAGDgAAABcwMDAxLzAxLzAxIDAwOjAwOjAwLjAwMAYPAAAAFzAwMDEvMDEvMDEgMDA6MDA6MDAuMDAwBhAAAAAHQ0lCIENMTwYRAAAAD1BpcGVsaW5lIEV2ZW50cwULAAAAGUludGVybmFsLlNlcnZlci5Ub3BpY0luZm8CAAAAGjxUb3BpY05hbWU+a19fQmFja2luZ0ZpZWxkGDxUb3BpY0lkPmtfX0JhY2tpbmdGaWVsZAEBAgAAAAYSAAAAEUluIFByb2Nlc3MgRXZlbnRzBhMAAAAkM2NkM2UxZWItOTFkZS00MDE5LWJhZGYtMjkxMTc1MDgxZGVlBA0AAAAgU3lzdGVtLkdsb2JhbGl6YXRpb24uQ3VsdHVyZUluZm8KAAAADG1faXNSZWFkT25seQtjb21wYXJlSW5mbwh0ZXh0SW5mbwdudW1JbmZvDGRhdGVUaW1lSW5mbwhjYWxlbmRhcgptX2RhdGFJdGVtCWN1bHR1cmVJRAZtX25hbWURbV91c2VVc2VyT3ZlcnJpZGUAAwMDAwMAAAEAASBTeXN0ZW0uR2xvYmFsaXphdGlvbi5Db21wYXJlSW5mbx1TeXN0ZW0uR2xvYmFsaXphdGlvbi5UZXh0SW5mbyVTeXN0ZW0uR2xvYmFsaXphdGlvbi5OdW1iZXJGb3JtYXRJbmZvJ1N5c3RlbS5HbG9iYWxpemF0aW9uLkRhdGVUaW1lRm9ybWF0SW5mbx1TeXN0ZW0uR2xvYmFsaXphdGlvbi5DYWxlbmRhcggIAQAJFAAAAAoKCgoAAAAACQQAAAYVAAAABWVuLVVTAQQUAAAAIFN5c3RlbS5HbG9iYWxpemF0aW9uLkNvbXBhcmVJbmZvBAAAAAZtX25hbWUJd2luMzJMQ0lEB2N1bHR1cmUNbV9Tb3J0VmVyc2lvbgEAAAMICCBTeXN0ZW0uR2xvYmFsaXphdGlvbi5Tb3J0VmVyc2lvbgYWAAAABWVuLVVTAAAAAAkEAAAKCw==";
        string serializedAdomdConnectionDefinition = "AAEAAAD/////AQAAAAAAAAAMAgAAAExDb25uZWN0aW9uRGVmaW5pdGlvbnMsIFZlcnNpb249MS4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsBQEAAAA8SW5mb3IuUE0uQ29tbW9uLkNvbm5lY3Rpb25EZWZpbml0aW9ucy5Bc0Nvbm5lY3Rpb25EZWZpbml0aW9uDAAAADFBZG9tZENvbm5lY3Rpb25EZWZpbml0aW9uKzxTZXJ2ZXI+a19fQmFja2luZ0ZpZWxkMUFkb21kQ29ubmVjdGlvbkRlZmluaXRpb24rPFVzZXJJZD5rX19CYWNraW5nRmllbGQ8QWRvbWRDb25uZWN0aW9uRGVmaW5pdGlvbis8RW5jcnlwdGVkUGFzc3dvcmQ+a19fQmFja2luZ0ZpZWxkKENvbm5lY3Rpb25EZWZpbml0aW9uKzxJZD5rX19CYWNraW5nRmllbGQqQ29ubmVjdGlvbkRlZmluaXRpb24rPE5hbWU+a19fQmFja2luZ0ZpZWxkMUNvbm5lY3Rpb25EZWZpbml0aW9uKzxEZXNjcmlwdGlvbj5rX19CYWNraW5nRmllbGQuQ29ubmVjdGlvbkRlZmluaXRpb24rPENhdGVnb3J5PmtfX0JhY2tpbmdGaWVsZDRDb25uZWN0aW9uRGVmaW5pdGlvbis8Q29ubmVjdGlvblR5cGU+a19fQmFja2luZ0ZpZWxkLkNvbm5lY3Rpb25EZWZpbml0aW9uKzxEYXRhYmFzZT5rX19CYWNraW5nRmllbGQ2Q29ubmVjdGlvbkRlZmluaXRpb24rPExhc3RNb2RpZmllZFVzZXI+a19fQmFja2luZ0ZpZWxkMkNvbm5lY3Rpb25EZWZpbml0aW9uKzxMYXN0TW9kaWZpZWQ+a19fQmFja2luZ0ZpZWxkPkNvbm5lY3Rpb25EZWZpbml0aW9uKzxFeHRlbmRlZENvbm5lY3Rpb25TdHJpbmc+a19fQmFja2luZ0ZpZWxkAQEBAwEBBAQBAQEBC1N5c3RlbS5HdWlkOEluZm9yLlBNLkNvbW1vbi5Db25uZWN0aW9uRGVmaW5pdGlvbnMuQ29ubmVjdGlvbkNhdGVnb3J5AgAAADRJbmZvci5QTS5Db21tb24uQ29ubmVjdGlvbkRlZmluaXRpb25zLkNvbm5lY3Rpb25UeXBlAgAAAAIAAAAGAwAAADhodHRwOi8vZHNzYXBwMDMuZHNzcHJlcHJvZC5jb20vRGF0YVB1bXBfQ0lCL21zbWRwdW1wLmRsbAYEAAAAFWRzc3ByZXByb2RccnJ5dmtpbl9mYQYFAAAASCN2ZW5jcnlwdGVkI1NSeEp2a1JvU1J4SnZrUXA1SUhELzh4OCtsVVc1djh3YXdOb1dNS1orVFZsUDZlRXRkVXkvejZlR0JBPQT6////C1N5c3RlbS5HdWlkCwAAAAJfYQJfYgJfYwJfZAJfZQJfZgJfZwJfaAJfaQJfagJfawAAAAAAAAAAAAAACAcHAgICAgICAgLXB/8se8lBQ6/82bi3OfSUBgcAAAAHQ0lCIENMTwYIAAAAAAX3////OEluZm9yLlBNLkNvbW1vbi5Db25uZWN0aW9uRGVmaW5pdGlvbnMuQ29ubmVjdGlvbkNhdGVnb3J5AQAAAAd2YWx1ZV9fAAgCAAAAAQAAAAX2////NEluZm9yLlBNLkNvbW1vbi5Db25uZWN0aW9uRGVmaW5pdGlvbnMuQ29ubmVjdGlvblR5cGUBAAAAB3ZhbHVlX18ACAIAAAABAAAABgsAAAAMQ0lCIENMTyBQUk9ECQgAAAAGDQAAABAyMDE4LTA3LTI0IDE1OjI2Cgs=";

        
        
        string serializedViewSessionPAT = "AAEAAAD/////AQAAAAAAAAAMAgAAAENEZWNpc2lvbkNvcmUsIFZlcnNpb249MS4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsBQEAAAAqSW5mb3IuUE0uRGVjaXNpb24uRGVjaXNpb25Db3JlLlZpZXdTZXNzaW9uFAAAAA5tb2RlbFNoYXBlRGF0ZRN1c2VyU2VjdXJlU2hhcGVEYXRlCGNhY2hlS2V5D3Nlc3Npb25DYWNoZUtleRdzZXNzaW9uQ2FjaGVLZXlXaXRoVXNlcgx2aWV3c0RCQWxpYXMIdmlld05hbWUQZGF0YWJhc2VVc2VyTmFtZQtzZXNzaW9uRGF0YRlhbGxvd2VkTWVtYmVyc0xhc3RDaGFuZ2VkEGNvbm5lY3Rpb25Tb3VyY2UVY2xpZW50UHJvY2Vzc0NvbXBsZXRlGjxUb3BpY0luZm8+a19fQmFja2luZ0ZpZWxkITxEYXRhYmFzZVBhc3N3b3JkPmtfX0JhY2tpbmdGaWVsZBg8Q3VsdHVyZT5rX19CYWNraW5nRmllbGQgPEZvcmNlQWRtaW5Mb2dpbj5rX19CYWNraW5nRmllbGQoPEZvcm1hdHRlZE1vZGVsU2hhcGVEYXRlPmtfX0JhY2tpbmdGaWVsZC08Rm9ybWF0dGVkVXNlclNlY3VyZVNoYXBlRGF0ZT5rX19CYWNraW5nRmllbGQfPENvbm5lY3Rpb25OYW1lPmtfX0JhY2tpbmdGaWVsZBk8Q3ViZU5hbWU+a19fQmFja2luZ0ZpZWxkAAABAQEBAQEBAAQABAEDAAEBAQENDQ0vSW5mb3IuUE0uRGVjaXNpb24uRGVjaXNpb25Db3JlLkNvbm5lY3Rpb25Tb3VyY2UCAAAAARlJbnRlcm5hbC5TZXJ2ZXIuVG9waWNJbmZvAgAAACBTeXN0ZW0uR2xvYmFsaXphdGlvbi5DdWx0dXJlSW5mbwECAAAAAAAAAAAAAAAAAAAAAAAAAAYDAAAAPCNSQUJPX1ZJRVdTI1JBRl9MV19BVkdPU0dST1dUSCNDTElFTlQjUlJZVktJTkBEU1NQUkVQUk9ELkNPTQYEAAAAPSNSQUJPX1ZJRVdTI1JBRl9MV19BVkdPU0dST1dUSCNDTElFTlQjMjAxOC8wMi8wNyAwOToyODoxMy4wMDAGBQAAAFQjUkFCT19WSUVXUyNSQUZfTFdfQVZHT1NHUk9XVEgjQ0xJRU5UIzIwMTgvMDIvMDcgMDk6Mjg6MTMuMDAwI1JSWVZLSU5ARFNTUFJFUFJPRC5DT00GBgAAAApSQUJPX1ZpZXdzBgcAAAASUkFGX0xXX0F2Z09TR3Jvd3RoBggAAAAWcnJ5dmtpbkBkc3NwcmVwcm9kLmNvbQYJAAAAPDIwMTgvMDQvMTkgMDg6NTY6MzcuNjUzI2UwNzcxMjU0LWM0Y2ItNDFjYS1hOWViLTA5MzkzZGYxNzkyNoA0OhwNbtUIBfb///8vSW5mb3IuUE0uRGVjaXNpb24uRGVjaXNpb25Db3JlLkNvbm5lY3Rpb25Tb3VyY2UBAAAAB3ZhbHVlX18ACAIAAAACAAAAAAkLAAAABgwAAAAIS2lyb3ZhNjQJDQAAAAAGDgAAABcwMDAxLzAxLzAxIDAwOjAwOjAwLjAwMAYPAAAAFzAwMDEvMDEvMDEgMDA6MDA6MDAuMDAwBhAAAAAPUkFGIFZJU0lPTiBQUk9EBhEAAAAHTFcgQ3ViZQULAAAAGUludGVybmFsLlNlcnZlci5Ub3BpY0luZm8CAAAAGjxUb3BpY05hbWU+a19fQmFja2luZ0ZpZWxkGDxUb3BpY0lkPmtfX0JhY2tpbmdGaWVsZAEBAgAAAAYSAAAAF0xvYW4gT3V0c3RhbmRpbmcgR3Jvd3RoBhMAAAAkYTYwNjQzNTctYmYxNC00NDhiLWExNmQtZWEzMDM3OTRlZjk0BA0AAAAgU3lzdGVtLkdsb2JhbGl6YXRpb24uQ3VsdHVyZUluZm8KAAAADG1faXNSZWFkT25seQtjb21wYXJlSW5mbwh0ZXh0SW5mbwdudW1JbmZvDGRhdGVUaW1lSW5mbwhjYWxlbmRhcgptX2RhdGFJdGVtCWN1bHR1cmVJRAZtX25hbWURbV91c2VVc2VyT3ZlcnJpZGUAAwMDAwMAAAEAASBTeXN0ZW0uR2xvYmFsaXphdGlvbi5Db21wYXJlSW5mbx1TeXN0ZW0uR2xvYmFsaXphdGlvbi5UZXh0SW5mbyVTeXN0ZW0uR2xvYmFsaXphdGlvbi5OdW1iZXJGb3JtYXRJbmZvJ1N5c3RlbS5HbG9iYWxpemF0aW9uLkRhdGVUaW1lRm9ybWF0SW5mbx1TeXN0ZW0uR2xvYmFsaXphdGlvbi5DYWxlbmRhcggIAQAJFAAAAAoKCgoAAAAACQQAAAYVAAAABWVuLVVTAQQUAAAAIFN5c3RlbS5HbG9iYWxpemF0aW9uLkNvbXBhcmVJbmZvBAAAAAZtX25hbWUJd2luMzJMQ0lEB2N1bHR1cmUNbV9Tb3J0VmVyc2lvbgEAAAMICCBTeXN0ZW0uR2xvYmFsaXphdGlvbi5Tb3J0VmVyc2lvbgYWAAAABWVuLVVTAAAAAAkEAAAKCw==";
        string serializedAdomdConnectionDefinitionPAT = "AAEAAAD/////AQAAAAAAAAAMAgAAAExDb25uZWN0aW9uRGVmaW5pdGlvbnMsIFZlcnNpb249MS4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsBQEAAAA8SW5mb3IuUE0uQ29tbW9uLkNvbm5lY3Rpb25EZWZpbml0aW9ucy5Bc0Nvbm5lY3Rpb25EZWZpbml0aW9uDAAAADFBZG9tZENvbm5lY3Rpb25EZWZpbml0aW9uKzxTZXJ2ZXI+a19fQmFja2luZ0ZpZWxkMUFkb21kQ29ubmVjdGlvbkRlZmluaXRpb24rPFVzZXJJZD5rX19CYWNraW5nRmllbGQ8QWRvbWRDb25uZWN0aW9uRGVmaW5pdGlvbis8RW5jcnlwdGVkUGFzc3dvcmQ+a19fQmFja2luZ0ZpZWxkKENvbm5lY3Rpb25EZWZpbml0aW9uKzxJZD5rX19CYWNraW5nRmllbGQqQ29ubmVjdGlvbkRlZmluaXRpb24rPE5hbWU+a19fQmFja2luZ0ZpZWxkMUNvbm5lY3Rpb25EZWZpbml0aW9uKzxEZXNjcmlwdGlvbj5rX19CYWNraW5nRmllbGQuQ29ubmVjdGlvbkRlZmluaXRpb24rPENhdGVnb3J5PmtfX0JhY2tpbmdGaWVsZDRDb25uZWN0aW9uRGVmaW5pdGlvbis8Q29ubmVjdGlvblR5cGU+a19fQmFja2luZ0ZpZWxkLkNvbm5lY3Rpb25EZWZpbml0aW9uKzxEYXRhYmFzZT5rX19CYWNraW5nRmllbGQ2Q29ubmVjdGlvbkRlZmluaXRpb24rPExhc3RNb2RpZmllZFVzZXI+a19fQmFja2luZ0ZpZWxkMkNvbm5lY3Rpb25EZWZpbml0aW9uKzxMYXN0TW9kaWZpZWQ+a19fQmFja2luZ0ZpZWxkPkNvbm5lY3Rpb25EZWZpbml0aW9uKzxFeHRlbmRlZENvbm5lY3Rpb25TdHJpbmc+a19fQmFja2luZ0ZpZWxkAQEBAwEBBAQBAQEBC1N5c3RlbS5HdWlkOEluZm9yLlBNLkNvbW1vbi5Db25uZWN0aW9uRGVmaW5pdGlvbnMuQ29ubmVjdGlvbkNhdGVnb3J5AgAAADRJbmZvci5QTS5Db21tb24uQ29ubmVjdGlvbkRlZmluaXRpb25zLkNvbm5lY3Rpb25UeXBlAgAAAAIAAAAGAwAAADhodHRwOi8vZHNzYXBwMDMuZHNzcHJlcHJvZC5jb20vZGF0YXB1bXBfcmFmL21zbWRwdW1wLmRsbAYEAAAAFWRzc3ByZXByb2RccnJ5dmtpbl9mYQYFAAAASCN2ZW5jcnlwdGVkI1VoRHZiaVJFVWhEdmJpUUZ0eVdZZ0ZQYXdtOGIydlYwb1hIUE9MVEVNcms3UE1sYmxDbmNIL3BsZE9vPQT6////C1N5c3RlbS5HdWlkCwAAAAJfYQJfYgJfYwJfZAJfZQJfZgJfZwJfaAJfaQJfagJfawAAAAAAAAAAAAAACAcHAgICAgICAgKSlleJdDIDQKzs6oV9p9qbBgcAAAAPUkFGIFZJU0lPTiBQUk9EBggAAAAABff///84SW5mb3IuUE0uQ29tbW9uLkNvbm5lY3Rpb25EZWZpbml0aW9ucy5Db25uZWN0aW9uQ2F0ZWdvcnkBAAAAB3ZhbHVlX18ACAIAAAABAAAABfb///80SW5mb3IuUE0uQ29tbW9uLkNvbm5lY3Rpb25EZWZpbml0aW9ucy5Db25uZWN0aW9uVHlwZQEAAAAHdmFsdWVfXwAIAgAAAAEAAAAGCwAAAA9SQUYgVmlzaW9uIEV2ZW4JCAAAAAYNAAAAEDIwMTgtMDItMDcgMDg6MjEKCw==";
        
        [TestMethod]
        public void LoadModel()
        {
            ViewSession viewSession = (ViewSession)StringToObject(serializedViewSession);
            AdomdConnectionDefinition adomdConnectionDefinition = (AdomdConnectionDefinition)StringToObject(serializedAdomdConnectionDefinition);
            Model model = new Model();
            DateTime d = model.Load(viewSession, adomdConnectionDefinition);
            
        }

        [TestMethod]
        public void LoadModelPAT()
        {
            ViewSession viewSession = (ViewSession)StringToObject(serializedViewSessionPAT);
            AdomdConnectionDefinition adomdConnectionDefinition = (AdomdConnectionDefinition)StringToObject(serializedAdomdConnectionDefinitionPAT);
            Model model = new Model();
            DateTime d = model.Load(viewSession, adomdConnectionDefinition);

        }


        [TestMethod]
        public void TestModelXML()
        {
            ViewSession viewSession = (ViewSession)StringToObject(serializedViewSession);
            AdomdConnectionDefinition adomdConnectionDefinition = (AdomdConnectionDefinition)StringToObject(serializedAdomdConnectionDefinition);
            Model model = new Model();
            model.Temp(viewSession, adomdConnectionDefinition);

        }





        public string ObjectToString(object obj)
        {
            using (System.IO.MemoryStream ms = new System.IO.MemoryStream())
            {
                new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter().Serialize(ms, obj);
                return Convert.ToBase64String(ms.ToArray());
            }
        }

        public object StringToObject(string base64String)
        {
            byte[] bytes = Convert.FromBase64String(base64String);
            using (System.IO.MemoryStream ms = new System.IO.MemoryStream(bytes, 0, bytes.Length))
            {
                ms.Write(bytes, 0, bytes.Length);
                ms.Position = 0;
                return new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter().Deserialize(ms);
            }
        }
    }
}
